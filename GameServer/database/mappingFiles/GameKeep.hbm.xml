<?xml version="1.0" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.0">
	<class name="DOL.GS.AbstractGameKeep, GameServer" table="`Keep`">
		<id name="KeepID" type="Int32" column="`KeepID`" unsaved-value="0">
			<generator class="native" />
		</id>
    <discriminator column="IsTower"/>
    <property name="Name" type="String(255)" not-null="true" column="`Name`"/>
		<property name="Region" type="Int32" not-null="true" column="`Region`"/>
    <component name="Position" class="DOL.GS.Point, GameServer">
      <property name="X" type="Int32" not-null="true" column="`X`"/>
      <property name="Y" type="Int32" not-null="true" column="`Y`"/>
      <property name="Z" type="Int32" not-null="true" column="`Z`"/>
    </component>
    <many-to-one name="Guild" column="`GuildName`" class="DOL.GS.Guild, GameServer" />
		<property name="Heading" type="Int32" not-null="true" column="`Heading`"/>
		<property name="Realm" type="Int32" not-null="true" column="`Realm`"/>
		<property name="Level" type="Int32" not-null="true" column="`Level`"/>
		<property name="AlbionDifficultyLevel" type="Int32" not-null="true" column="`AlbionDifficultyLevel`"/>
		<property name="MidgardDifficultyLevel" type="Int32" not-null="true" column="`MidgardDifficultyLevel`"/>
		<property name="HiberniaDifficultyLevel" type="Int32" not-null="true" column="`HiberniaDifficultyLevel`"/>
		<property name="OriginalRealm" type="Int32" not-null="true" column="`OriginalRealm`"/>
		<property name="KeepType" type="Int32" not-null="true" column="`KeepType`"/>
    <bag name="KeepComponents" inverse="true" cascade="all" table="`KeepComponent`">
      <key column="KeepID" />
      <one-to-many class="DOL.GS.GameKeepComponent, GameServer"/>
    </bag>
    <subclass name="DOL.GS.GameKeep, GameServer">
      <bag name="Towers" inverse="true" cascade="all" table="`KeepTower`">
        <key column="KeepID" />
        <one-to-many class="DOL.GS.GameKeepTower, GameServer"/>
      </bag>
    </subclass>

    <subclass name="DOL.GS.GameKeepTower, GameServer">
      <many-to-one name="Keep" column="`LinkedKeepID`" class="DOL.GS.GameKeep, GameServer" />
    </subclass>
	</class>
</hibernate-mapping>
